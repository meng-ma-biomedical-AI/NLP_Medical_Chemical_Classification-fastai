kind: job
metadata:
  name: hyper-param-clas-search
  tag: ''
  hash: da8a79c822ba13341b49e1f88b148aafca28b3c4
  project: default
  labels:
    author: nschenone
  categories:
  - hyperparameter
  - ml
spec:
  command: ''
  args: []
  image: mlrun/ml-models-gpu
  env: []
  resources:
    limits:
      nvidia.com/gpu: 1
  default_handler: train_clas_model
  entry_points:
    get_min_grad:
      name: get_min_grad
      doc: ''
      parameters:
      - name: model
        default: ''
      outputs:
      - default: ''
      lineno: 13
    train_clas_model:
      name: train_clas_model
      doc: ''
      parameters:
      - name: context
        default: ''
      outputs:
      - default: ''
      lineno: 18
  description: hyperparameter tuning for classification model
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKZnJvbSBvcyBpbXBvcnQgcGF0aAppbXBvcnQgcGFuZGFzIGFzIHBkCmltcG9ydCBudW1weSBhcyBucAppbXBvcnQgcmFuZG9tCmltcG9ydCBmYXN0YWkKaW1wb3J0IGpzb24KZnJvbSBmYXN0YWkudGV4dCBpbXBvcnQgKgpmcm9tIGZhc3RhaS5jYWxsYmFja3MgaW1wb3J0ICoKdG9yY2guY3VkYS5zZXRfZGV2aWNlKDApCgpkZWYgZ2V0X21pbl9ncmFkKG1vZGVsKToKICAgIG1vZGVsLmxyX2ZpbmQobnVtX2l0PTIwMCkKICAgIG1vZGVsLnJlY29yZGVyLnBsb3Qoc3VnZ2VzdGlvbj1UcnVlKQogICAgcmV0dXJuIG1vZGVsLnJlY29yZGVyLm1pbl9ncmFkX2xyCgpkZWYgdHJhaW5fY2xhc19tb2RlbChjb250ZXh0KToKICAgIGJzID0gaW50KGNvbnRleHQuZ2V0X3BhcmFtKCdicycpKQogICAgdGhyZXNoID0gZmxvYXQoY29udGV4dC5nZXRfcGFyYW0oJ3RocmVzaCcpKQogICAgZHJvcF9tdWx0ID0gZmxvYXQoY29udGV4dC5nZXRfcGFyYW0oJ2Ryb3BfbXVsdCcpKQogICAgZXBvY2hzID0gaW50KGNvbnRleHQuZ2V0X3BhcmFtKCdlcG9jaHMnKSkKICAgIG51bV9zYW1wbGVzID0gaW50KGNvbnRleHQuZ2V0X3BhcmFtKCdudW1fc2FtcGxlcycpKQogICAgZW5jb2RpbmdzID0gY29udGV4dC5nZXRfcGFyYW0oJ2VuY29kaW5ncycpCiAgICBkYXRhX2NsYXNfcGF0aCA9IGNvbnRleHQuZ2V0X3BhcmFtKCdkYXRhX2NsYXNfcGF0aCcpCiAgICAKICAgIHZlcnNpb24gPSBmInNhbXBsZV97bnVtX3NhbXBsZXN9LnBrbCIKICAgIGRhdGFfY2xhcyA9IGxvYWRfZGF0YSgiIiwgZGF0YV9jbGFzX3BhdGgsIGJzPWJzLCAqKnsibnVtX3dvcmtlcnMiIDogMH0pCgogICAgYWNjID0gcGFydGlhbChhY2N1cmFjeV90aHJlc2gsIHRocmVzaD10aHJlc2gpCiAgICBmX3Njb3JlID0gcGFydGlhbChmYmV0YSwgdGhyZXNoPXRocmVzaCkKICAgIG1ldHJpY3MgPSBbYWNjLCBmX3Njb3JlXQoKICAgIGVhcmx5X3N0b3AgPSBwYXJ0aWFsKEVhcmx5U3RvcHBpbmdDYWxsYmFjaywKICAgICAgICAgICAgICAgICAgICAgICAgIG1vbml0b3I9J2ZiZXRhJywKICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU9Im1heCIsCiAgICAgICAgICAgICAgICAgICAgICAgICBtaW5fZGVsdGE9MC4wMDEsCiAgICAgICAgICAgICAgICAgICAgICAgICBwYXRpZW5jZT01KQoKICAgIGNhbGxiYWNrX2ZucyA9IFtlYXJseV9zdG9wXQoKICAgIGxlYXJuX2NsYXMgPSB0ZXh0X2NsYXNzaWZpZXJfbGVhcm5lcihkYXRhX2NsYXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVdEX0xTVE0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcF9tdWx0PWRyb3BfbXVsdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRyaWNzPW1ldHJpY3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tfZm5zPWNhbGxiYWNrX2ZucykudG9fZnAxNigpCiAgICBsZWFybl9jbGFzLmxvYWRfZW5jb2RlcihlbmNvZGluZ3MpCiAgICBsZWFybl9jbGFzLmZyZWV6ZSgpCiAgICAKICAgIG1vZGVsX25hbWUgPSBmImxlYXJuX2NsYXNfe3ZlcnNpb259X2JzX3tic31fdGhyZXNoX3t0aHJlc2h9X2Ryb3BtdWx0X3tkcm9wX211bHR9IgogICAgc2F2ZV9iZXN0ID0gU2F2ZU1vZGVsQ2FsbGJhY2sobGVhcm5fY2xhcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZXJ5PSdpbXByb3ZlbWVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb25pdG9yPSJmYmV0YSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlPSJtYXgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT1tb2RlbF9uYW1lKQogICAgY2FsbGJhY2tzID0gW3NhdmVfYmVzdF0KCiAgICBtaW5fZ3JhZCA9IGdldF9taW5fZ3JhZChsZWFybl9jbGFzKQogICAgbGVhcm5fY2xhcy5maXRfb25lX2N5Y2xlKDEsIG1pbl9ncmFkLCBjYWxsYmFja3M9Y2FsbGJhY2tzKQogICAgbGVhcm5fY2xhcy51bmZyZWV6ZSgpCgogICAgbWluX2dyYWQgPSBnZXRfbWluX2dyYWQobGVhcm5fY2xhcykKICAgIGxlYXJuX2NsYXMuZml0X29uZV9jeWNsZShlcG9jaHMsIHNsaWNlKG1pbl9ncmFkLG1pbl9ncmFkKjEwMCksIG1vbXM9KDAuOCwwLjcpLCBjYWxsYmFja3M9Y2FsbGJhY2tzKQogICAgCiAgICBiZXN0X2ZiZXRhID0gbWF4KFtpWzFdIGZvciBpIGluIGxlYXJuX2NsYXMucmVjb3JkZXIubWV0cmljc10pLml0ZW0oKQogICAgCiAgICBwYXJhbXMgPSB7ImJzIjogYnMsICJ0aHJlc2giIDogdGhyZXNoLCAiZHJvcF9tdWx0IiA6IGRyb3BfbXVsdCwgImVwb2NocyIgOiBlcG9jaHN9CiAgICAKICAgIGNvbnRleHQubG9nX3Jlc3VsdCgnZmJldGEnLCBiZXN0X2ZiZXRhKQogICAgY29udGV4dC5sb2dfbW9kZWwoImJlc3RfcGFyYW1zIiwgYm9keT1qc29uLmR1bXBzKHBhcmFtcywgaW5kZW50PTIpLmVuY29kZSgndXRmLTgnKSwKICAgICAgICAgICAgICAgICAgICAgIGFydGlmYWN0X3BhdGg9Y29udGV4dC5hcnRpZmFjdF9zdWJwYXRoKCdtb2RlbHMnKSwKICAgICAgICAgICAgICAgICAgICAgIG1vZGVsX2ZpbGU9InBhcmFtcy5qc29uIikKCg==
    commands: []
    code_origin: https://github.com/nschenone/NLP_Dev.git#10629776eea268f5080b9e2187a89f53f13a6575:hyper_param_clas_search.ipynb
